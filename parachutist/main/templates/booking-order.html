{% extends "abstract-index.html" %}

{% block head %}
{% load static %}
<title>Бронирование</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Open+Sans&family=Ruda&display=swap" rel="stylesheet">

<link rel="stylesheet" href="{% static 'css/slick.css' %}">
<link rel="stylesheet" href="{% static 'css/jquery.fancybox.css' %}">

<link rel="stylesheet" href="{% static 'bootstrap-5.1.3-dist/css/bootstrap.min.css' %}">
<link rel="stylesheet" href="{% static 'css/style.min.css' %}">
<link rel="stylesheet" href="{% static 'css/booking-order.css' %}">

{% endblock %}

{% block content %}

<section class="booking__order-section">
    <div class="container">
        <form action="" method="post" class="main__content d-flex justify-content-between" style="max-width: 1200px;">
            <div style="width: 400px;">
                {% csrf_token %}
                <div class="form-row">
                    <div>
                        <label for="{{order_room_form.last_name.id_for_label}}">{{order_room_form.last_name.label}}</label>
                        {{order_room_form.last_name}}
                        <div class="invalid-feedback">{{order_room_form.last_name.errors}}</div>
                    </div>
                    <div>
                        <label for="{{order_room_form.name.id_for_label}}">{{order_room_form.name.label}}</label>
                        {{order_room_form.name}}
                        <div class="invalid-feedback">{{order_room_form.name.errors}}</div>
                    </div>
                    <div>
                        <label for="{{order_room_form.phone.id_for_label}}">{{order_room_form.phone.label}}</label>
                        {{order_room_form.phone}}
                        <div class="invalid-feedback">{{order_room_form.phone.errors}}</div>
                    </div>
                    <div>
                        <label for="{{order_room_form.email.id_for_label}}">{{order_room_form.email.label}}</label>
                        <div class="input-group">
                            <div class="input-group-prepend">
                                <span class="input-group-text" id="inputGroupPrepend2">@</span>
                            </div>
                            {{order_room_form.email}}
                            <div class="invalid-feedback">{{order_room_form.email.errors}}</div>
                        </div>
                    </div>
                </div>

            </div>
            <div class="booking__date">
                <div>
                    <p>{{order_room_form.start_date.label}}</p>
                    <p>{{order_room_form.start_date}}</p>
                </div>
                <div>
                    <p>{{order_room_form.end_date.label}}</p>
                    <p>{{order_room_form.end_date}}</p>
                </div>
            </div>
            <div class="booking__information">
                <dl class="row" style="width: 400px;">
                    <table class="table">
                        <thead>
                            <tr>
                                <th scope="col" style="padding-top: 0;">Тип номера</th>
                                <th scope="col" style="padding-top: 0;">количество</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for room_select in rooms_selected %}
                            <tr>
                                <td>{{room_select.room.room_type}}</td>
                                <td>{{room_select.count}}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </dl>
                <p class="result" id="sumPrice">ИТОГ: 0</p>

                <button class='btn btn-primary booking-btn' type="submit">Забронировать</button>

            </div>
        </form>
    </div>
</section>
<script>
    var sumPrice = 0
    var arrivalDate=Date.parse(document.getElementById('id_start_date').value)
    var departureDate=Date.parse(document.getElementById('id_end_date').value)

    const diffTime = Math.abs(departureDate - arrivalDate);
    diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
    {% for room_select in rooms_selected %}
        sumPrice+={{room_select.room.price|safe}} * {{room_select.count}} * diffDays
    {% endfor %}
    document.getElementById('sumPrice').innerText = 'ИТОГ: ' + sumPrice + '₽'
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js'></script>
<script src="{% static 'bootstrap-5.1.3-dist/js/bootstrap.min.js' %}"></script>
{% endblock %}